Version 4
SHEET 1 2116 1020
WIRE -336 -368 -336 -400
WIRE -400 -256 -432 -256
WIRE -240 -256 -272 -256
WIRE -336 -112 -336 -144
WIRE 880 -48 848 -48
WIRE 992 -48 944 -48
WIRE 112 16 80 16
WIRE 224 16 192 16
WIRE 848 48 848 -48
WIRE 880 48 848 48
WIRE 992 48 992 -48
WIRE 992 48 960 48
WIRE 1488 48 1456 48
WIRE 1600 48 1568 48
WIRE -240 80 -272 80
WIRE -208 80 -240 80
WIRE -80 80 -128 80
WIRE -32 80 -80 80
WIRE 80 80 80 16
WIRE 80 80 48 80
WIRE 1248 112 1216 112
WIRE 1456 112 1456 48
WIRE 1456 112 1328 112
WIRE -240 128 -240 80
WIRE -80 128 -80 80
WIRE 80 144 80 80
WIRE 112 144 80 144
WIRE 224 160 224 16
WIRE 224 160 176 160
WIRE 272 160 224 160
WIRE 384 160 352 160
WIRE 416 160 384 160
WIRE 640 160 608 160
WIRE 736 160 704 160
WIRE 848 160 848 48
WIRE 848 160 816 160
WIRE 880 160 848 160
WIRE 1456 160 1456 112
WIRE 1488 160 1456 160
WIRE 112 176 80 176
WIRE 992 176 992 48
WIRE 992 176 944 176
WIRE 1024 176 992 176
WIRE 1216 176 1216 112
WIRE 1216 176 1184 176
WIRE 1600 176 1600 48
WIRE 1600 176 1552 176
WIRE 1632 176 1600 176
WIRE 1920 176 1888 176
WIRE 384 192 384 160
WIRE 880 192 848 192
WIRE 1488 192 1456 192
WIRE 2032 192 1984 192
WIRE 2064 192 2032 192
WIRE 1920 208 1888 208
WIRE -240 240 -240 208
WIRE -240 240 -272 240
WIRE -208 240 -240 240
WIRE -80 240 -80 192
WIRE -80 240 -128 240
WIRE -32 240 -80 240
WIRE 80 240 80 176
WIRE 80 240 48 240
WIRE 1216 240 1216 176
WIRE 1248 240 1216 240
WIRE 1392 240 1328 240
WIRE 1456 240 1456 192
WIRE 1456 240 1392 240
WIRE 848 256 848 192
WIRE 848 256 816 256
WIRE 1392 272 1392 240
WIRE 1456 272 1456 240
WIRE -32 336 -64 336
WIRE 80 336 80 240
WIRE 80 336 48 336
WIRE 1824 352 1824 320
WIRE 1888 352 1888 208
WIRE 1888 352 1824 352
WIRE 1920 352 1888 352
WIRE 2032 352 2032 192
WIRE 2032 352 2000 352
WIRE 1456 384 1456 352
WIRE 1456 384 1424 384
WIRE 1824 384 1824 352
FLAG 112 -256 0
FLAG 112 -336 Vcc
FLAG 144 128 Vcc
FLAG 144 192 0
FLAG 272 -256 0
FLAG 272 -336 Vref
FLAG 384 256 0
FLAG -272 80 0
FLAG -272 240 mot-
FLAG -64 336 Vref
FLAG 416 160 isen
FLAG 912 144 Vcc
FLAG 912 208 0
FLAG 608 160 isen
FLAG 816 256 Vref
FLAG 1520 144 Vcc
FLAG 1520 208 0
FLAG 1392 336 0
FLAG 1424 384 Vref
FLAG 1024 176 bpf
FLAG 1184 176 bpf
FLAG 1632 176 rpl
FLAG 1952 224 0
FLAG 1952 160 Vcc
FLAG 1824 464 0
FLAG 1824 240 Vcc
FLAG 1888 176 rpl
FLAG 2064 192 pls
FLAG -336 -400 mot+
FLAG -656 -64 0
FLAG -656 -144 mot+
FLAG -240 -256 mvel
FLAG -432 -256 mpos
FLAG -336 -112 mot-
SYMBOL OpAmps\\AD8542 144 96 R0
SYMATTR InstName U1
SYMBOL Comparators\\LT1720 1952 128 R0
SYMATTR InstName U3
SYMBOL res 64 64 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value {rin1}
SYMBOL voltage 112 -352 R0
SYMATTR InstName V1
SYMATTR Value {Vcc}
SYMBOL voltage 272 -352 R0
SYMATTR InstName V2
SYMATTR Value {Vcc/2}
SYMBOL res 64 224 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value {rin1}
SYMBOL res -112 64 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value {rin1}
SYMBOL res -112 224 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value {rin1}
SYMBOL cap -96 128 R0
SYMATTR InstName C1
SYMATTR Value {c1in}
SYMBOL res 64 320 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value {rg1}
SYMBOL res 208 0 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value {rg1}
SYMBOL res 368 144 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value {r1out}
SYMBOL cap 368 192 R0
SYMATTR InstName C2
SYMATTR Value {c1out}
SYMBOL res -224 224 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName Rsen1
SYMATTR Value {Rsen}
SYMBOL OpAmps\\AD8542 912 112 R0
SYMATTR InstName U2
SYMBOL cap 704 144 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C3
SYMATTR Value {c2a}
SYMBOL res 832 144 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value {r2a}
SYMBOL res 976 32 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value {r2b}
SYMBOL cap 944 -64 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C4
SYMATTR Value {c2b}
SYMBOL OpAmps\\AD8542 1520 112 R0
SYMATTR InstName U4
SYMBOL res 1344 96 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value {r3a}
SYMBOL res 1344 224 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R11
SYMATTR Value {r3a}
SYMBOL cap 1408 336 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C5
SYMATTR Value {c3a}
SYMBOL res 1440 256 R0
SYMATTR InstName R12
SYMATTR Value {r3b}
SYMBOL res 1584 32 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R13
SYMATTR Value {r3b}
SYMBOL res 1840 336 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R14
SYMATTR Value {r4a}
SYMBOL res 1840 480 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R15
SYMATTR Value {r4a}
SYMBOL res 2016 336 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R16
SYMATTR Value {r4b}
SYMBOL dc_motor -336 -256 R0
WINDOW 0 -53 -64 Bottom 2
SYMATTR InstName X1
SYMBOL voltage -656 -160 R0
SYMATTR InstName V3
SYMATTR Value {Vmot}
TEXT 160 -744 Left 2 !.param rin1=1k rg1=220k r1out=1k c1in=56p c1out=1n
TEXT 168 -688 Left 2 !.param c2a=6.8n r2a=220k c2b=68p r2b=1.5meg
TEXT 168 -632 Left 2 !.param r3a=22k c3a=1n r3b=1.5meg
TEXT 168 -576 Left 2 !.param r4a=1k r4b=3.3k
TEXT 160 -792 Left 2 !.param Vcc=5 Rsen=0.05 Vmot=12
TEXT -690 488 Left 2 !.tran 0 0.5 0 10u startup
TEXT 168 -536 Left 2 !.options reltol=0.00001
